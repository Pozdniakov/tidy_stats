<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Ковариация и корреляция | Анализ данных и статистика в R</title>
  <meta name="description" content="16 Ковариация и корреляция | Анализ данных и статистика в R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Ковариация и корреляция | Анализ данных и статистика в R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Ковариация и корреляция | Анализ данных и статистика в R" />
  
  
  

<meta name="author" content="Поздняков Иван" />


<meta name="date" content="2021-11-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ttest.html"/>
<link rel="next" href="lm.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.16/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Анализ данных и статистика в R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Введение в R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#install"><i class="fa fa-check"></i><b>2.1</b> Установка R и Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> Знакомство с RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#calc"><i class="fa fa-check"></i><b>2.3</b> R как калькулятор</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#func"><i class="fa fa-check"></i><b>2.4</b> Функции</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#google"><i class="fa fa-check"></i><b>2.5</b> В любой непонятной ситуации – гуглите</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#variables"><i class="fa fa-check"></i><b>2.6</b> Переменные</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#logic"><i class="fa fa-check"></i><b>2.7</b> Логические операторы</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>3</b> Вектор</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vector.html"><a href="vector.html#atomic"><i class="fa fa-check"></i><b>3.1</b> Понятие atomic вектора в R</a></li>
<li class="chapter" data-level="3.2" data-path="vector.html"><a href="vector.html#coercion"><i class="fa fa-check"></i><b>3.2</b> Приведение типов</a></li>
<li class="chapter" data-level="3.3" data-path="vector.html"><a href="vector.html#vector_op"><i class="fa fa-check"></i><b>3.3</b> Векторизация</a></li>
<li class="chapter" data-level="3.4" data-path="vector.html"><a href="vector.html#recycling"><i class="fa fa-check"></i><b>3.4</b> Ресайклинг</a></li>
<li class="chapter" data-level="3.5" data-path="vector.html"><a href="vector.html#index_atomic"><i class="fa fa-check"></i><b>3.5</b> Индексирование векторов</a></li>
<li class="chapter" data-level="3.6" data-path="vector.html"><a href="vector.html#logic_vectors"><i class="fa fa-check"></i><b>3.6</b> Работа с логическими векторами</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="vector.html"><a href="vector.html#logic_mean_sum"><i class="fa fa-check"></i><b>3.6.1</b> <code>mean()</code> и <code>sum()</code> для подсчета пропорций и количества TRUE</a></li>
<li class="chapter" data-level="3.6.2" data-path="vector.html"><a href="vector.html#all_any"><i class="fa fa-check"></i><b>3.6.2</b> <code>all()</code> и <code>any()</code></a></li>
<li class="chapter" data-level="3.6.3" data-path="vector.html"><a href="vector.html#which"><i class="fa fa-check"></i><b>3.6.3</b> Превращение логических значений в индексы: <code>which()</code></a></li>
<li class="chapter" data-level="3.6.4" data-path="vector.html"><a href="vector.html#in"><i class="fa fa-check"></i><b>3.6.4</b> оператор %in% и match()</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="vector.html"><a href="vector.html#na"><i class="fa fa-check"></i><b>3.7</b> NA - пропущенные значения</a></li>
<li class="chapter" data-level="3.8" data-path="vector.html"><a href="vector.html#vector_end"><i class="fa fa-check"></i><b>3.8</b> Заключение</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="complex_structures.html"><a href="complex_structures.html"><i class="fa fa-check"></i><b>4</b> Сложные структуры данных в R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="complex_structures.html"><a href="complex_structures.html#matrix"><i class="fa fa-check"></i><b>4.1</b> Матрица</a></li>
<li class="chapter" data-level="4.2" data-path="complex_structures.html"><a href="complex_structures.html#arrays"><i class="fa fa-check"></i><b>4.2</b> Массив</a></li>
<li class="chapter" data-level="4.3" data-path="complex_structures.html"><a href="complex_structures.html#list"><i class="fa fa-check"></i><b>4.3</b> Список</a></li>
<li class="chapter" data-level="4.4" data-path="complex_structures.html"><a href="complex_structures.html#df"><i class="fa fa-check"></i><b>4.4</b> Датафрейм</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r_packages.html"><a href="r_packages.html"><i class="fa fa-check"></i><b>5</b> Пакеты в R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="r_packages.html"><a href="r_packages.html#extra_pack"><i class="fa fa-check"></i><b>5.1</b> Дополнительные пакеты</a></li>
<li class="chapter" data-level="5.2" data-path="r_packages.html"><a href="r_packages.html#r_built_in"><i class="fa fa-check"></i><b>5.2</b> Встроенные пакеты R</a></li>
<li class="chapter" data-level="5.3" data-path="r_packages.html"><a href="r_packages.html#install_cran"><i class="fa fa-check"></i><b>5.3</b> Установка пакетов с CRAN</a></li>
<li class="chapter" data-level="5.4" data-path="r_packages.html"><a href="r_packages.html#package_load"><i class="fa fa-check"></i><b>5.4</b> Загрузка установленного пакета</a></li>
<li class="chapter" data-level="5.5" data-path="r_packages.html"><a href="r_packages.html#from_package"><i class="fa fa-check"></i><b>5.5</b> Вызов функции из пакета с помощью <code>::</code></a></li>
<li class="chapter" data-level="5.6" data-path="r_packages.html"><a href="r_packages.html#install_bioc"><i class="fa fa-check"></i><b>5.6</b> Установка пакетов c Bioconductor</a></li>
<li class="chapter" data-level="5.7" data-path="r_packages.html"><a href="r_packages.html#install_github"><i class="fa fa-check"></i><b>5.7</b> Установка пакетов с Github</a></li>
<li class="chapter" data-level="5.8" data-path="r_packages.html"><a href="r_packages.html#where_packages"><i class="fa fa-check"></i><b>5.8</b> Где искать нужные пакеты</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="real_data.html"><a href="real_data.html"><i class="fa fa-check"></i><b>6</b> Импорт и экспорт данных</a>
<ul>
<li class="chapter" data-level="6.1" data-path="real_data.html"><a href="real_data.html#wd"><i class="fa fa-check"></i><b>6.1</b> Рабочая папка и проекты RStudio</a></li>
<li class="chapter" data-level="6.2" data-path="real_data.html"><a href="real_data.html#project_workflow"><i class="fa fa-check"></i><b>6.2</b> Организация проектов</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="real_data.html"><a href="real_data.html#text_binary"><i class="fa fa-check"></i><b>6.2.1</b> Табличные данные: текстовые и бинарные данные</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="real_data.html"><a href="real_data.html#check_imported"><i class="fa fa-check"></i><b>6.3</b> Проверка импортированных данных</a></li>
<li class="chapter" data-level="6.4" data-path="real_data.html"><a href="real_data.html#export_data"><i class="fa fa-check"></i><b>6.4</b> Экспорт данных</a></li>
<li class="chapter" data-level="6.5" data-path="real_data.html"><a href="real_data.html#binary"><i class="fa fa-check"></i><b>6.5</b> Импорт таблиц в бинарном формате: таблицы Excel, SPSS</a></li>
<li class="chapter" data-level="6.6" data-path="real_data.html"><a href="real_data.html#fastread"><i class="fa fa-check"></i><b>6.6</b> Быстрый импорт данных</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="loops_conditions.html"><a href="loops_conditions.html"><i class="fa fa-check"></i><b>7</b> Условные конструкции и циклы</a>
<ul>
<li class="chapter" data-level="7.1" data-path="loops_conditions.html"><a href="loops_conditions.html#if"><i class="fa fa-check"></i><b>7.1</b> Выражения <code>if</code>, <code>else</code>, <code>else if</code></a></li>
<li class="chapter" data-level="7.2" data-path="loops_conditions.html"><a href="loops_conditions.html#for"><i class="fa fa-check"></i><b>7.2</b> Циклы <code>for</code></a></li>
<li class="chapter" data-level="7.3" data-path="loops_conditions.html"><a href="loops_conditions.html#ifelse"><i class="fa fa-check"></i><b>7.3</b> Векторизованные условные конструкции: функции <code>ifelse()</code> и <code>dplyr::case_when()</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="functional.html"><a href="functional.html"><i class="fa fa-check"></i><b>8</b> Функциональное программирование в R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="functional.html"><a href="functional.html#create_fun"><i class="fa fa-check"></i><b>8.1</b> Создание функций</a></li>
<li class="chapter" data-level="8.2" data-path="functional.html"><a href="functional.html#sanity_check"><i class="fa fa-check"></i><b>8.2</b> Проверка на адекватность</a></li>
<li class="chapter" data-level="8.3" data-path="functional.html"><a href="functional.html#why_functions"><i class="fa fa-check"></i><b>8.3</b> Когда и зачем создавать функции?</a></li>
<li class="chapter" data-level="8.4" data-path="functional.html"><a href="functional.html#functions_objects"><i class="fa fa-check"></i><b>8.4</b> Функции как объекты первого порядка</a></li>
<li class="chapter" data-level="8.5" data-path="functional.html"><a href="functional.html#apply_f"><i class="fa fa-check"></i><b>8.5</b> Семейство функций apply()</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="functional.html"><a href="functional.html#apply"><i class="fa fa-check"></i><b>8.5.1</b> Применение <code>apply()</code> для матриц</a></li>
<li class="chapter" data-level="8.5.2" data-path="functional.html"><a href="functional.html#anon_f"><i class="fa fa-check"></i><b>8.5.2</b> Анонимные функции</a></li>
<li class="chapter" data-level="8.5.3" data-path="functional.html"><a href="functional.html#apply_other"><i class="fa fa-check"></i><b>8.5.3</b> Другие функции семейства <code>apply()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tidy_intro.html"><a href="tidy_intro.html"><i class="fa fa-check"></i><b>9</b> Введение в tidyverse</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_verse"><i class="fa fa-check"></i><b>9.1</b> Вселенная tidyverse</a></li>
<li class="chapter" data-level="9.2" data-path="tidy_intro.html"><a href="tidy_intro.html#загрузка-данных-с-помощью-readr"><i class="fa fa-check"></i><b>9.2</b> Загрузка данных с помощью <code>readr</code></a></li>
<li class="chapter" data-level="9.3" data-path="tidy_intro.html"><a href="tidy_intro.html#pipe"><i class="fa fa-check"></i><b>9.3</b> magrittr::<code>%&gt;%</code></a></li>
<li class="chapter" data-level="9.4" data-path="tidy_intro.html"><a href="tidy_intro.html#главные-пакеты-tidyverse-dplyr-и-tidyr"><i class="fa fa-check"></i><b>9.4</b> Главные пакеты tidyverse: <code>dplyr</code> и <code>tidyr</code></a></li>
<li class="chapter" data-level="9.5" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_select_cols"><i class="fa fa-check"></i><b>9.5</b> Работа с колонками тиббла</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="tidy_intro.html"><a href="tidy_intro.html#выбор-колонок-dplyrselect"><i class="fa fa-check"></i><b>9.5.1</b> Выбор колонок: <code>dplyr::select()</code></a></li>
<li class="chapter" data-level="9.5.2" data-path="tidy_intro.html"><a href="tidy_intro.html#tidyselect"><i class="fa fa-check"></i><b>9.5.2</b> Мини-язык tidyselect для выбора колонок</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_select_rows"><i class="fa fa-check"></i><b>9.6</b> Работа со строками тиббла</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_slice"><i class="fa fa-check"></i><b>9.6.1</b> Выбор строк по номеру: <code>dplyr::slice()</code></a></li>
<li class="chapter" data-level="9.6.2" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_filter"><i class="fa fa-check"></i><b>9.6.2</b> Выбор строк по условию: <code>dplyr::filter()</code></a></li>
<li class="chapter" data-level="9.6.3" data-path="tidy_intro.html"><a href="tidy_intro.html#slice_family"><i class="fa fa-check"></i><b>9.6.3</b> Семейство функций <code>slice()</code></a></li>
<li class="chapter" data-level="9.6.4" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_drop_na"><i class="fa fa-check"></i><b>9.6.4</b> Удаление строчек с NA: <code>tidyr::drop_na()</code></a></li>
<li class="chapter" data-level="9.6.5" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_arrange"><i class="fa fa-check"></i><b>9.6.5</b> Сортировка строк: <code>dplyr::arrange()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_mutate"><i class="fa fa-check"></i><b>9.7</b> Создание колонок: <code>dplyr::mutate()</code> и <code>dplyr::transmute()</code></a></li>
<li class="chapter" data-level="9.8" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_aggregate"><i class="fa fa-check"></i><b>9.8</b> Агрегация данных в тиббле</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="tidy_intro.html"><a href="tidy_intro.html#summarise"><i class="fa fa-check"></i><b>9.8.1</b> Подытоживание: <code>summarise()</code></a></li>
<li class="chapter" data-level="9.8.2" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_group"><i class="fa fa-check"></i><b>9.8.2</b> Группировка: <code>group_by()</code></a></li>
<li class="chapter" data-level="9.8.3" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_count"><i class="fa fa-check"></i><b>9.8.3</b> Подсчет строк: <code>dplyr::n()</code>, <code>dplyr::count()</code></a></li>
<li class="chapter" data-level="9.8.4" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_distinct"><i class="fa fa-check"></i><b>9.8.4</b> Уникальные значения: <code>dplyr::distinct()</code></a></li>
<li class="chapter" data-level="9.8.5" data-path="tidy_intro.html"><a href="tidy_intro.html#tidy_group_mutate"><i class="fa fa-check"></i><b>9.8.5</b> Создание колонок с группировкой</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tidyverse_advanced.html"><a href="tidyverse_advanced.html"><i class="fa fa-check"></i><b>10</b> Продвинутый tidyverse</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tidyverse_advanced.html"><a href="tidyverse_advanced.html#tidy_several"><i class="fa fa-check"></i><b>10.1</b> Объединение нескольких датафреймов</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tidyverse_advanced.html"><a href="tidyverse_advanced.html#tidy_bind"><i class="fa fa-check"></i><b>10.1.1</b> Соединение структурно схожих датафреймов: bind_rows(), bind_cols()</a></li>
<li class="chapter" data-level="10.1.2" data-path="tidyverse_advanced.html"><a href="tidyverse_advanced.html#tidy_join"><i class="fa fa-check"></i><b>10.1.2</b> Реляционные данные: <code>*_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tidyverse_advanced.html"><a href="tidyverse_advanced.html#tidy_data"><i class="fa fa-check"></i><b>10.2</b> Tidy data: <code>tidyr::pivot_longer()</code>, <code>tidyr::pivot_wider()</code></a></li>
<li class="chapter" data-level="10.3" data-path="tidyverse_advanced.html"><a href="tidyverse_advanced.html#трансформация-нескольких-колонок-dplyracross"><i class="fa fa-check"></i><b>10.3</b> Трансформация нескольких колонок: <code>dplyr::across()</code></a></li>
<li class="chapter" data-level="10.4" data-path="tidyverse_advanced.html"><a href="tidyverse_advanced.html#purrr"><i class="fa fa-check"></i><b>10.4</b> Функциональное программирование: <code>purrr</code></a></li>
<li class="chapter" data-level="10.5" data-path="tidyverse_advanced.html"><a href="tidyverse_advanced.html#list_colums_nest"><i class="fa fa-check"></i><b>10.5</b> Колонки-списки и нестинг: <code>nest()</code></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="vdesc.html"><a href="vdesc.html"><i class="fa fa-check"></i><b>11</b> Описательная статистика</a>
<ul>
<li class="chapter" data-level="11.1" data-path="vdesc.html"><a href="vdesc.html#desc_infer"><i class="fa fa-check"></i><b>11.1</b> Описательная статистика и статистика вывода</a></li>
<li class="chapter" data-level="11.2" data-path="vdesc.html"><a href="vdesc.html#типы-шкал"><i class="fa fa-check"></i><b>11.2</b> Типы шкал</a></li>
<li class="chapter" data-level="11.3" data-path="vdesc.html"><a href="vdesc.html#cent_tend"><i class="fa fa-check"></i><b>11.3</b> Меры центральной тенденции</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="vdesc.html"><a href="vdesc.html#mean"><i class="fa fa-check"></i><b>11.3.1</b> Арифметическое среднее</a></li>
<li class="chapter" data-level="11.3.2" data-path="vdesc.html"><a href="vdesc.html#median"><i class="fa fa-check"></i><b>11.3.2</b> Медиана</a></li>
<li class="chapter" data-level="11.3.3" data-path="vdesc.html"><a href="vdesc.html#trim"><i class="fa fa-check"></i><b>11.3.3</b> Усеченное среднее (trimmed mean)</a></li>
<li class="chapter" data-level="11.3.4" data-path="vdesc.html"><a href="vdesc.html#mode"><i class="fa fa-check"></i><b>11.3.4</b> Мода</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="vdesc.html"><a href="vdesc.html#vary"><i class="fa fa-check"></i><b>11.4</b> Меры рассеяния</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="vdesc.html"><a href="vdesc.html#var"><i class="fa fa-check"></i><b>11.4.1</b> Дисперсия</a></li>
<li class="chapter" data-level="11.4.2" data-path="vdesc.html"><a href="vdesc.html#sd"><i class="fa fa-check"></i><b>11.4.2</b> Стандартное отклонение</a></li>
<li class="chapter" data-level="11.4.3" data-path="vdesc.html"><a href="vdesc.html#mad"><i class="fa fa-check"></i><b>11.4.3</b> Медианное абсолютное отклонение</a></li>
<li class="chapter" data-level="11.4.4" data-path="vdesc.html"><a href="vdesc.html#iqr"><i class="fa fa-check"></i><b>11.4.4</b> Межквартильный размах</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="vdesc.html"><a href="vdesc.html#skku"><i class="fa fa-check"></i><b>11.5</b> Ассиметрия и эксцесс</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="vdesc.html"><a href="vdesc.html#skew"><i class="fa fa-check"></i><b>11.5.1</b> Ассиметрия</a></li>
<li class="chapter" data-level="11.5.2" data-path="vdesc.html"><a href="vdesc.html#kurtosis"><i class="fa fa-check"></i><b>11.5.2</b> Эксцесс</a></li>
<li class="chapter" data-level="11.5.3" data-path="vdesc.html"><a href="vdesc.html#skewR"><i class="fa fa-check"></i><b>11.5.3</b> Ассиметрия и эксцесс в R</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="vdesc.html"><a href="vdesc.html#quantiles"><i class="fa fa-check"></i><b>11.6</b> Квантили</a></li>
<li class="chapter" data-level="11.7" data-path="vdesc.html"><a href="vdesc.html#summary"><i class="fa fa-check"></i><b>11.7</b> А теперь все вместе!</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="r_vis.html"><a href="r_vis.html"><i class="fa fa-check"></i><b>12</b> Визуализация в R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="r_vis.html"><a href="r_vis.html#base_vis"><i class="fa fa-check"></i><b>12.1</b> Базовые функции для графики</a></li>
<li class="chapter" data-level="12.2" data-path="r_vis.html"><a href="r_vis.html#grammar_of_graphics"><i class="fa fa-check"></i><b>12.2</b> История грамматики графики</a></li>
<li class="chapter" data-level="12.3" data-path="r_vis.html"><a href="r_vis.html#gg_base"><i class="fa fa-check"></i><b>12.3</b> Основы грамматики графики</a></li>
<li class="chapter" data-level="12.4" data-path="r_vis.html"><a href="r_vis.html#gg_0"><i class="fa fa-check"></i><b>12.4</b> Пример №0: пайчарт с распределение по полу</a></li>
<li class="chapter" data-level="12.5" data-path="r_vis.html"><a href="r_vis.html#gg_1"><i class="fa fa-check"></i><b>12.5</b> Пример №1: Education and IQ meta-analysis</a></li>
<li class="chapter" data-level="12.6" data-path="r_vis.html"><a href="r_vis.html#gg_ext"><i class="fa fa-check"></i><b>12.6</b> Расширения <code>ggplot2</code></a></li>
<li class="chapter" data-level="12.7" data-path="r_vis.html"><a href="r_vis.html#vis_dynamic"><i class="fa fa-check"></i><b>12.7</b> Динамические визуализации в R</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="r_vis.html"><a href="r_vis.html#html_w"><i class="fa fa-check"></i><b>12.7.1</b> Интерфейс для JavaScript фреймворков: пакет <code>htmlwidgets</code></a></li>
<li class="chapter" data-level="12.7.2" data-path="r_vis.html"><a href="r_vis.html#plotly"><i class="fa fa-check"></i><b>12.7.2</b> Динамические визуализации в <code>plotly</code></a></li>
<li class="chapter" data-level="12.7.3" data-path="r_vis.html"><a href="r_vis.html#html_other"><i class="fa fa-check"></i><b>12.7.3</b> Другие пакеты для динамической визуализации</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="rmd.html"><a href="rmd.html"><i class="fa fa-check"></i><b>13</b> R Markdown</a>
<ul>
<li class="chapter" data-level="13.1" data-path="rmd.html"><a href="rmd.html#rmd_what"><i class="fa fa-check"></i><b>13.1</b> Что такое R Markdown</a></li>
<li class="chapter" data-level="13.2" data-path="rmd.html"><a href="rmd.html#rmd_begin"><i class="fa fa-check"></i><b>13.2</b> Начало работы в R Markdown</a></li>
<li class="chapter" data-level="13.3" data-path="rmd.html"><a href="rmd.html#rmd_str"><i class="fa fa-check"></i><b>13.3</b> Структура R Markdown документа</a></li>
<li class="chapter" data-level="13.4" data-path="rmd.html"><a href="rmd.html#chunk"><i class="fa fa-check"></i><b>13.4</b> Настройки чанка</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="rmd.html"><a href="rmd.html#chunks"><i class="fa fa-check"></i><b>13.4.1</b> Настройка нескольких чанков</a></li>
<li class="chapter" data-level="13.4.2" data-path="rmd.html"><a href="rmd.html#python"><i class="fa fa-check"></i><b>13.4.2</b> Чанки с Python и другими языками программирования</a></li>
<li class="chapter" data-level="13.4.3" data-path="rmd.html"><a href="rmd.html#inline"><i class="fa fa-check"></i><b>13.4.3</b> Код вне чанков (inline code)</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="rmd.html"><a href="rmd.html#md"><i class="fa fa-check"></i><b>13.5</b> Синтаксис Markdown (без R)</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="rmd.html"><a href="rmd.html#md_high"><i class="fa fa-check"></i><b>13.5.1</b> Выделение текста</a></li>
<li class="chapter" data-level="13.5.2" data-path="rmd.html"><a href="rmd.html#headers"><i class="fa fa-check"></i><b>13.5.2</b> Заголовки разных уровней</a></li>
<li class="chapter" data-level="13.5.3" data-path="rmd.html"><a href="rmd.html#md_lists"><i class="fa fa-check"></i><b>13.5.3</b> Списки</a></li>
<li class="chapter" data-level="13.5.4" data-path="rmd.html"><a href="rmd.html#md_cite"><i class="fa fa-check"></i><b>13.5.4</b> Цитаты</a></li>
<li class="chapter" data-level="13.5.5" data-path="rmd.html"><a href="rmd.html#rmd_tables"><i class="fa fa-check"></i><b>13.5.5</b> Таблицы</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="rmd.html"><a href="rmd.html#extra_rmd"><i class="fa fa-check"></i><b>13.6</b> Дополнительные возможности R Markdown</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="rmd.html"><a href="rmd.html#dynamic_tables"><i class="fa fa-check"></i><b>13.6.1</b> Динамические таблицы</a></li>
<li class="chapter" data-level="13.6.2" data-path="rmd.html"><a href="rmd.html#vis"><i class="fa fa-check"></i><b>13.6.2</b> Графики в R Markdown</a></li>
<li class="chapter" data-level="13.6.3" data-path="rmd.html"><a href="rmd.html#html_inside"><i class="fa fa-check"></i><b>13.6.3</b> HTML-код</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="infer_stats.html"><a href="infer_stats.html"><i class="fa fa-check"></i><b>14</b> Статистика вывода</a>
<ul>
<li class="chapter" data-level="14.1" data-path="infer_stats.html"><a href="infer_stats.html#infer_intro"><i class="fa fa-check"></i><b>14.1</b> Введение в статистику вывода</a></li>
<li class="chapter" data-level="14.2" data-path="infer_stats.html"><a href="infer_stats.html#distributions"><i class="fa fa-check"></i><b>14.2</b> Распределения</a></li>
<li class="chapter" data-level="14.3" data-path="infer_stats.html"><a href="infer_stats.html#estimates"><i class="fa fa-check"></i><b>14.3</b> Оценки</a></li>
<li class="chapter" data-level="14.4" data-path="infer_stats.html"><a href="infer_stats.html#sample_estimate"><i class="fa fa-check"></i><b>14.4</b> Точечные оценки</a></li>
<li class="chapter" data-level="14.5" data-path="infer_stats.html"><a href="infer_stats.html#interval_estimate"><i class="fa fa-check"></i><b>14.5</b> Интервальные оценки</a></li>
<li class="chapter" data-level="14.6" data-path="infer_stats.html"><a href="infer_stats.html#sample_dist"><i class="fa fa-check"></i><b>14.6</b> Выборочное распределение</a></li>
<li class="chapter" data-level="14.7" data-path="infer_stats.html"><a href="infer_stats.html#nordm_dist_importance"><i class="fa fa-check"></i><b>14.7</b> Важность нормального распределения</a></li>
<li class="chapter" data-level="14.8" data-path="infer_stats.html"><a href="infer_stats.html#clt"><i class="fa fa-check"></i><b>14.8</b> Центральная предельная теорема</a></li>
<li class="chapter" data-level="14.9" data-path="infer_stats.html"><a href="infer_stats.html#ci_build"><i class="fa fa-check"></i><b>14.9</b> Строим доверительный интервал</a></li>
<li class="chapter" data-level="14.10" data-path="infer_stats.html"><a href="infer_stats.html#тестирование-значимости-нулевой-гипотезы-nhst"><i class="fa fa-check"></i><b>14.10</b> Тестирование значимости нулевой гипотезы (#nhst)</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>15</b> t-тест</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ttest.html"><a href="ttest.html#one_ttest"><i class="fa fa-check"></i><b>15.1</b> Одновыборочный t-тест</a></li>
<li class="chapter" data-level="15.2" data-path="ttest.html"><a href="ttest.html#two_ttest"><i class="fa fa-check"></i><b>15.2</b> Двухвыборочный t-тест</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ttest.html"><a href="ttest.html#dep_ttest"><i class="fa fa-check"></i><b>15.2.1</b> Двухвыборочный зависимый t-тест</a></li>
<li class="chapter" data-level="15.2.2" data-path="ttest.html"><a href="ttest.html#ind_ttest"><i class="fa fa-check"></i><b>15.2.2</b> Двухвыборочный независимый t-тест</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ttest.html"><a href="ttest.html#assumptions_ttest"><i class="fa fa-check"></i><b>15.3</b> Допущения t-теста</a></li>
<li class="chapter" data-level="15.4" data-path="ttest.html"><a href="ttest.html#nonparam_ttest"><i class="fa fa-check"></i><b>15.4</b> Непараметрические аналоги t-теста</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="ttest.html"><a href="ttest.html#wilcox_test"><i class="fa fa-check"></i><b>15.4.1</b> Тест Уилкоксона</a></li>
<li class="chapter" data-level="15.4.2" data-path="ttest.html"><a href="ttest.html#mann_test"><i class="fa fa-check"></i><b>15.4.2</b> Тест Манна-Уитни</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="cov_cor.html"><a href="cov_cor.html"><i class="fa fa-check"></i><b>16</b> Ковариация и корреляция</a>
<ul>
<li class="chapter" data-level="16.1" data-path="cov_cor.html"><a href="cov_cor.html#cov"><i class="fa fa-check"></i><b>16.1</b> Ковариация</a></li>
<li class="chapter" data-level="16.2" data-path="cov_cor.html"><a href="cov_cor.html#cor"><i class="fa fa-check"></i><b>16.2</b> Корреляция</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="cov_cor.html"><a href="cov_cor.html#pearson_cor"><i class="fa fa-check"></i><b>16.2.1</b> Коэффициент корреляции Пирсона</a></li>
<li class="chapter" data-level="16.2.2" data-path="cov_cor.html"><a href="cov_cor.html#nonparam_cor"><i class="fa fa-check"></i><b>16.2.2</b> Непараметрические коэффициенты корреляции</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="cov_cor.html"><a href="cov_cor.html#cor_mat"><i class="fa fa-check"></i><b>16.3</b> Корреляционная матрица</a></li>
<li class="chapter" data-level="16.4" data-path="cov_cor.html"><a href="cov_cor.html#hitmap_cor"><i class="fa fa-check"></i><b>16.4</b> Хитмэп корреляций</a></li>
<li class="chapter" data-level="16.5" data-path="cov_cor.html"><a href="cov_cor.html#матрица-корреляций-в-виде-графа"><i class="fa fa-check"></i><b>16.5</b> Матрица корреляций в виде графа</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>17</b> Линейная регрессия</a>
<ul>
<li class="chapter" data-level="17.1" data-path="lm.html"><a href="lm.html#lm_func"><i class="fa fa-check"></i><b>17.1</b> Функция <code>lm()</code></a></li>
<li class="chapter" data-level="17.2" data-path="lm.html"><a href="lm.html#interpret_lm"><i class="fa fa-check"></i><b>17.2</b> Интерпретация вывода линейной регрессии</a></li>
<li class="chapter" data-level="17.3" data-path="lm.html"><a href="lm.html#lm_a"><i class="fa fa-check"></i><b>17.3</b> Допущения линейной регрессии</a></li>
<li class="chapter" data-level="17.4" data-path="lm.html"><a href="lm.html#outliers_lm"><i class="fa fa-check"></i><b>17.4</b> Влияние выбросов на линейную модель</a></li>
<li class="chapter" data-level="17.5" data-path="lm.html"><a href="lm.html#lm_mult"><i class="fa fa-check"></i><b>17.5</b> Множественная линейная регрессия</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>18</b> Дисперсионный анализ (ANOVA)</a>
<ul>
<li class="chapter" data-level="18.0.1" data-path="anova.html"><a href="anova.html#aov"><i class="fa fa-check"></i><b>18.0.1</b> Функция aov()</a></li>
<li class="chapter" data-level="18.1" data-path="anova.html"><a href="anova.html#anova_nhst"><i class="fa fa-check"></i><b>18.1</b> Тестирование значимости нулевой гипотезы в ANOVA.</a></li>
<li class="chapter" data-level="18.2" data-path="anova.html"><a href="anova.html#anova_posthoc"><i class="fa fa-check"></i><b>18.2</b> Post-hoc тесты</a></li>
<li class="chapter" data-level="18.3" data-path="anova.html"><a href="anova.html#aov_as_lm"><i class="fa fa-check"></i><b>18.3</b> ANOVA и т-тест как частные случаи линейной регрессии</a></li>
<li class="chapter" data-level="18.4" data-path="anova.html"><a href="anova.html#dummy"><i class="fa fa-check"></i><b>18.4</b> Dummy coding</a></li>
<li class="chapter" data-level="18.5" data-path="anova.html"><a href="anova.html#aova"><i class="fa fa-check"></i><b>18.5</b> Допущения ANOVA</a></li>
<li class="chapter" data-level="18.6" data-path="anova.html"><a href="anova.html#fact_aov"><i class="fa fa-check"></i><b>18.6</b> Многофакторный дисперсионный анализ (Factorial ANOVA)</a></li>
<li class="chapter" data-level="18.7" data-path="anova.html"><a href="anova.html#rm_aov"><i class="fa fa-check"></i><b>18.7</b> Дисперсионный анализ с повторными измерениями (Repeated-measures ANOVA)</a></li>
<li class="chapter" data-level="18.8" data-path="anova.html"><a href="anova.html#mixed_aov"><i class="fa fa-check"></i><b>18.8</b> Смешанный дисперсионный анализ (Mixed between-within subjects ANOVA)</a></li>
<li class="chapter" data-level="18.9" data-path="anova.html"><a href="anova.html#nonparam_aov"><i class="fa fa-check"></i><b>18.9</b> Непараметрические аналоги ANOVA</a>
<ul>
<li class="chapter" data-level="18.9.1" data-path="anova.html"><a href="anova.html#krask_aov"><i class="fa fa-check"></i><b>18.9.1</b> Тест Краскела-Уоллеса</a></li>
<li class="chapter" data-level="18.9.2" data-path="anova.html"><a href="anova.html#friedman_aov"><i class="fa fa-check"></i><b>18.9.2</b> Тест Фридмана</a></li>
</ul></li>
<li class="chapter" data-level="18.10" data-path="anova.html"><a href="anova.html#aov_final"><i class="fa fa-check"></i><b>18.10</b> Заключение</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="glm_general.html"><a href="glm_general.html"><i class="fa fa-check"></i><b>19</b> Общая линейная модель и ее расширения</a>
<ul>
<li class="chapter" data-level="19.1" data-path="glm_general.html"><a href="glm_general.html#general_linear_model"><i class="fa fa-check"></i><b>19.1</b> Общая линейная модель</a></li>
<li class="chapter" data-level="19.2" data-path="glm_general.html"><a href="glm_general.html#glm_model"><i class="fa fa-check"></i><b>19.2</b> Обобщенная линейная модель</a></li>
<li class="chapter" data-level="19.3" data-path="glm_general.html"><a href="glm_general.html#lme_model"><i class="fa fa-check"></i><b>19.3</b> Модель со смешанными эффектами</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="plan.html"><a href="plan.html"><i class="fa fa-check"></i><b>20</b> Планирования научного исследования</a>
<ul>
<li class="chapter" data-level="20.1" data-path="plan.html"><a href="plan.html#quest_practices"><i class="fa fa-check"></i><b>20.1</b> Спорные исследовательские практики</a></li>
<li class="chapter" data-level="20.2" data-path="plan.html"><a href="plan.html#reproducible"><i class="fa fa-check"></i><b>20.2</b> Вопроизводимые исследования</a></li>
<li class="chapter" data-level="20.3" data-path="plan.html"><a href="plan.html#stat_power"><i class="fa fa-check"></i><b>20.3</b> Статистическая мощность</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html"><i class="fa fa-check"></i><b>21</b> Многомерные методы анализа данных</a>
<ul>
<li class="chapter" data-level="21.1" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html#анализ-главных-компонент"><i class="fa fa-check"></i><b>21.1</b> Анализ главных компонент</a></li>
<li class="chapter" data-level="21.2" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html#pca"><i class="fa fa-check"></i><b>21.2</b> Анализ главных компонент (Principal component analysis)</a></li>
<li class="chapter" data-level="21.3" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html#tsne"><i class="fa fa-check"></i><b>21.3</b> tSNE</a></li>
<li class="chapter" data-level="21.4" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html#эксплораторный-факторный-анализ"><i class="fa fa-check"></i><b>21.4</b> Эксплораторный факторный анализ</a></li>
<li class="chapter" data-level="21.5" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html#конфирматорный-факторный-анализ"><i class="fa fa-check"></i><b>21.5</b> Конфирматорный факторный анализ</a></li>
<li class="chapter" data-level="21.6" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html#кластерный-анализ"><i class="fa fa-check"></i><b>21.6</b> Кластерный анализ</a></li>
<li class="chapter" data-level="21.7" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html#многомерное-шкалирование"><i class="fa fa-check"></i><b>21.7</b> Многомерное шкалирование</a></li>
<li class="chapter" data-level="21.8" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html#сетевой-анализ"><i class="fa fa-check"></i><b>21.8</b> Сетевой анализ</a></li>
<li class="chapter" data-level="21.9" data-path="многомерные-методы-анализа-данных.html"><a href="многомерные-методы-анализа-данных.html#другие-методы-многомерного-анализа-данных"><i class="fa fa-check"></i><b>21.9</b> Другие методы многомерного анализа данных</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="tasks.html"><a href="tasks.html"><i class="fa fa-check"></i><b>22</b> Задания</a>
<ul>
<li class="chapter" data-level="22.1" data-path="tasks.html"><a href="tasks.html#task_begin"><i class="fa fa-check"></i><b>22.1</b> Начало работы в R</a></li>
<li class="chapter" data-level="22.2" data-path="tasks.html"><a href="tasks.html#task_new_vecs"><i class="fa fa-check"></i><b>22.2</b> Создание векторов</a></li>
<li class="chapter" data-level="22.3" data-path="tasks.html"><a href="tasks.html#task_coer"><i class="fa fa-check"></i><b>22.3</b> Приведение типов</a></li>
<li class="chapter" data-level="22.4" data-path="tasks.html"><a href="tasks.html#task_vec_ion"><i class="fa fa-check"></i><b>22.4</b> Векторизация</a></li>
<li class="chapter" data-level="22.5" data-path="tasks.html"><a href="tasks.html#task_vec_ind"><i class="fa fa-check"></i><b>22.5</b> Индексирование векторов</a></li>
<li class="chapter" data-level="22.6" data-path="tasks.html"><a href="tasks.html#task_na"><i class="fa fa-check"></i><b>22.6</b> Работа с пропущенными значениями</a></li>
<li class="chapter" data-level="22.7" data-path="tasks.html"><a href="tasks.html#task_matrix"><i class="fa fa-check"></i><b>22.7</b> Матрицы</a></li>
<li class="chapter" data-level="22.8" data-path="tasks.html"><a href="tasks.html#task_list"><i class="fa fa-check"></i><b>22.8</b> Списки</a></li>
<li class="chapter" data-level="22.9" data-path="tasks.html"><a href="tasks.html#task_df"><i class="fa fa-check"></i><b>22.9</b> Датафрейм</a></li>
<li class="chapter" data-level="22.10" data-path="tasks.html"><a href="tasks.html#task_if"><i class="fa fa-check"></i><b>22.10</b> Условные конструкции</a></li>
<li class="chapter" data-level="22.11" data-path="tasks.html"><a href="tasks.html#task_function"><i class="fa fa-check"></i><b>22.11</b> Создание функций</a></li>
<li class="chapter" data-level="22.12" data-path="tasks.html"><a href="tasks.html#task_sanity"><i class="fa fa-check"></i><b>22.12</b> Проверка на адекватность</a></li>
<li class="chapter" data-level="22.13" data-path="tasks.html"><a href="tasks.html#task_apply"><i class="fa fa-check"></i><b>22.13</b> Семейство функций apply()</a></li>
<li class="chapter" data-level="22.14" data-path="tasks.html"><a href="tasks.html#task_pipe"><i class="fa fa-check"></i><b>22.14</b> magrittr::<code>%&gt;%</code></a></li>
<li class="chapter" data-level="22.15" data-path="tasks.html"><a href="tasks.html#task_select"><i class="fa fa-check"></i><b>22.15</b> Выбор столбцов: <code>dplyr::select()</code></a></li>
<li class="chapter" data-level="22.16" data-path="tasks.html"><a href="tasks.html#task_filt"><i class="fa fa-check"></i><b>22.16</b> Выбор строк: <code>dplyr::slice()</code> и <code>dplyr::filter()</code></a></li>
<li class="chapter" data-level="22.17" data-path="tasks.html"><a href="tasks.html#task_arr"><i class="fa fa-check"></i><b>22.17</b> Сортировка строк: <code>dplyr::arrange()</code></a></li>
<li class="chapter" data-level="22.18" data-path="tasks.html"><a href="tasks.html#task_dist"><i class="fa fa-check"></i><b>22.18</b> Уникальные значения: <code>dplyr::distinct()</code></a></li>
<li class="chapter" data-level="22.19" data-path="tasks.html"><a href="tasks.html#task_mutate"><i class="fa fa-check"></i><b>22.19</b> Создание колонок: <code>dplyr::mutate()</code> и <code>dplyr::transmute()</code></a></li>
<li class="chapter" data-level="22.20" data-path="tasks.html"><a href="tasks.html#task_group_by"><i class="fa fa-check"></i><b>22.20</b> Агрегация: <code>dplyr::group_by() %&gt;% summarise()</code></a></li>
<li class="chapter" data-level="22.21" data-path="tasks.html"><a href="tasks.html#соединение-датафреймов-_join-task_join"><i class="fa fa-check"></i><b>22.21</b> Соединение датафреймов: *_join {#task_join}</a></li>
<li class="chapter" data-level="22.22" data-path="tasks.html"><a href="tasks.html#task_pivot"><i class="fa fa-check"></i><b>22.22</b> Tidy data</a></li>
<li class="chapter" data-level="22.23" data-path="tasks.html"><a href="tasks.html#task_across"><i class="fa fa-check"></i><b>22.23</b> Операции с несколькими колонками: <code>across()</code></a></li>
<li class="chapter" data-level="22.24" data-path="tasks.html"><a href="tasks.html#desc_tasks"><i class="fa fa-check"></i><b>22.24</b> Описательная статистика</a></li>
<li class="chapter" data-level="22.25" data-path="tasks.html"><a href="tasks.html#ggplot2_tasks"><i class="fa fa-check"></i><b>22.25</b> Построение графиков в <code>ggplot2</code></a></li>
<li class="chapter" data-level="22.26" data-path="tasks.html"><a href="tasks.html#dist_tasks"><i class="fa fa-check"></i><b>22.26</b> Распределения</a></li>
<li class="chapter" data-level="22.27" data-path="tasks.html"><a href="tasks.html#one_ttest_tasks"><i class="fa fa-check"></i><b>22.27</b> Одновыборочный t-test</a></li>
<li class="chapter" data-level="22.28" data-path="tasks.html"><a href="tasks.html#dep_ttest_tasks"><i class="fa fa-check"></i><b>22.28</b> Двухвыборочный зависимый t-test</a></li>
<li class="chapter" data-level="22.29" data-path="tasks.html"><a href="tasks.html#ind_ttest_tasks"><i class="fa fa-check"></i><b>22.29</b> Двухвыборочный независимый t-test</a></li>
<li class="chapter" data-level="22.30" data-path="tasks.html"><a href="tasks.html#nonparam_ttest_tasks"><i class="fa fa-check"></i><b>22.30</b> Непараметрические аналоги t-теста</a></li>
<li class="chapter" data-level="22.31" data-path="tasks.html"><a href="tasks.html#chi_sq_tasks"><i class="fa fa-check"></i><b>22.31</b> Критерий хи-квадрат Пирсона</a></li>
<li class="chapter" data-level="22.32" data-path="tasks.html"><a href="tasks.html#backpack_tasks"><i class="fa fa-check"></i><b>22.32</b> Исследование набора данных Backpack</a></li>
<li class="chapter" data-level="22.33" data-path="tasks.html"><a href="tasks.html#cov_tasks"><i class="fa fa-check"></i><b>22.33</b> Ковариация</a></li>
<li class="chapter" data-level="22.34" data-path="tasks.html"><a href="tasks.html#cor_tasks"><i class="fa fa-check"></i><b>22.34</b> Коэффициент корреляции</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>23</b> Решения заданий</a>
<ul>
<li class="chapter" data-level="23.1" data-path="solutions.html"><a href="solutions.html#solution_begin"><i class="fa fa-check"></i><b>23.1</b> Начало работы в R</a></li>
<li class="chapter" data-level="23.2" data-path="solutions.html"><a href="solutions.html#solution_new_vecs"><i class="fa fa-check"></i><b>23.2</b> Создание векторов</a></li>
<li class="chapter" data-level="23.3" data-path="solutions.html"><a href="solutions.html#solution_coer"><i class="fa fa-check"></i><b>23.3</b> Приведение типов</a></li>
<li class="chapter" data-level="23.4" data-path="solutions.html"><a href="solutions.html#solution_vec_ion"><i class="fa fa-check"></i><b>23.4</b> Векторизация</a></li>
<li class="chapter" data-level="23.5" data-path="solutions.html"><a href="solutions.html#solution_vec_ind"><i class="fa fa-check"></i><b>23.5</b> Индексирование векторов</a></li>
<li class="chapter" data-level="23.6" data-path="solutions.html"><a href="solutions.html#solution_na"><i class="fa fa-check"></i><b>23.6</b> Работа с пропущенными значениями</a></li>
<li class="chapter" data-level="23.7" data-path="solutions.html"><a href="solutions.html#solution_matrix"><i class="fa fa-check"></i><b>23.7</b> Матрицы</a></li>
<li class="chapter" data-level="23.8" data-path="solutions.html"><a href="solutions.html#solution_list"><i class="fa fa-check"></i><b>23.8</b> Списки</a></li>
<li class="chapter" data-level="23.9" data-path="solutions.html"><a href="solutions.html#solution_df"><i class="fa fa-check"></i><b>23.9</b> Датафрейм</a></li>
<li class="chapter" data-level="23.10" data-path="solutions.html"><a href="solutions.html#solution_if"><i class="fa fa-check"></i><b>23.10</b> Условные конструкции</a></li>
<li class="chapter" data-level="23.11" data-path="solutions.html"><a href="solutions.html#solution_function"><i class="fa fa-check"></i><b>23.11</b> Создание функций</a></li>
<li class="chapter" data-level="23.12" data-path="solutions.html"><a href="solutions.html#solution_sanity"><i class="fa fa-check"></i><b>23.12</b> Проверка на адекватность</a></li>
<li class="chapter" data-level="23.13" data-path="solutions.html"><a href="solutions.html#solution_apply"><i class="fa fa-check"></i><b>23.13</b> Семейство функций apply()</a></li>
<li class="chapter" data-level="23.14" data-path="solutions.html"><a href="solutions.html#solution_pipe"><i class="fa fa-check"></i><b>23.14</b> magrittr::<code>%&gt;%</code></a></li>
<li class="chapter" data-level="23.15" data-path="solutions.html"><a href="solutions.html#solution_select"><i class="fa fa-check"></i><b>23.15</b> Выбор столбцов: <code>dplyr::select()</code></a></li>
<li class="chapter" data-level="23.16" data-path="solutions.html"><a href="solutions.html#solution_filt"><i class="fa fa-check"></i><b>23.16</b> Выбор строк: <code>dplyr::slice()</code> и <code>dplyr::filter()</code></a></li>
<li class="chapter" data-level="23.17" data-path="solutions.html"><a href="solutions.html#solution_arr"><i class="fa fa-check"></i><b>23.17</b> Сортировка строк: <code>dplyr::arrange()</code></a></li>
<li class="chapter" data-level="23.18" data-path="solutions.html"><a href="solutions.html#solution_dist"><i class="fa fa-check"></i><b>23.18</b> Уникальные значения: <code>dplyr::distinct()</code></a></li>
<li class="chapter" data-level="23.19" data-path="solutions.html"><a href="solutions.html#solution_mutate"><i class="fa fa-check"></i><b>23.19</b> Создание колонок: <code>dplyr::mutate()</code> и <code>dplyr::transmute()</code></a></li>
<li class="chapter" data-level="23.20" data-path="solutions.html"><a href="solutions.html#solution_group_by"><i class="fa fa-check"></i><b>23.20</b> Агрегация: <code>dplyr::group_by() %&gt;% summarise()</code></a></li>
<li class="chapter" data-level="23.21" data-path="solutions.html"><a href="solutions.html#соединение-датафреймов-_join-solution_join"><i class="fa fa-check"></i><b>23.21</b> Соединение датафреймов: *_join {#solution_join}</a></li>
<li class="chapter" data-level="23.22" data-path="solutions.html"><a href="solutions.html#solution_pivot"><i class="fa fa-check"></i><b>23.22</b> Tidy data</a></li>
<li class="chapter" data-level="23.23" data-path="solutions.html"><a href="solutions.html#solution_across"><i class="fa fa-check"></i><b>23.23</b> Операции с несколькими колонками: <code>across()</code></a></li>
<li class="chapter" data-level="23.24" data-path="solutions.html"><a href="solutions.html#desc_solutions"><i class="fa fa-check"></i><b>23.24</b> Описательная статистика</a></li>
<li class="chapter" data-level="23.25" data-path="solutions.html"><a href="solutions.html#ggplot2_solutions"><i class="fa fa-check"></i><b>23.25</b> Построение графиков в <code>ggplot2</code></a></li>
<li class="chapter" data-level="23.26" data-path="solutions.html"><a href="solutions.html#dist_solutions"><i class="fa fa-check"></i><b>23.26</b> Распределения</a></li>
<li class="chapter" data-level="23.27" data-path="solutions.html"><a href="solutions.html#one_ttest_solutions"><i class="fa fa-check"></i><b>23.27</b> Одновыборочный t-test</a></li>
<li class="chapter" data-level="23.28" data-path="solutions.html"><a href="solutions.html#dep_ttest_solutions"><i class="fa fa-check"></i><b>23.28</b> Двухвыборочный зависимый t-test</a></li>
<li class="chapter" data-level="23.29" data-path="solutions.html"><a href="solutions.html#ind_ttest_solutions"><i class="fa fa-check"></i><b>23.29</b> Двухвыборочный независимый t-test</a></li>
<li class="chapter" data-level="23.30" data-path="solutions.html"><a href="solutions.html#nonparam_ttest_solutions"><i class="fa fa-check"></i><b>23.30</b> Непараметрические аналоги t-теста</a></li>
<li class="chapter" data-level="23.31" data-path="solutions.html"><a href="solutions.html#chi_sq_solutions"><i class="fa fa-check"></i><b>23.31</b> Критерий хи-квадрат Пирсона</a></li>
<li class="chapter" data-level="23.32" data-path="solutions.html"><a href="solutions.html#backpack_solutions"><i class="fa fa-check"></i><b>23.32</b> Исследование набора данных Backpack</a></li>
<li class="chapter" data-level="23.33" data-path="solutions.html"><a href="solutions.html#cov_solutions"><i class="fa fa-check"></i><b>23.33</b> Ковариация</a></li>
<li class="chapter" data-level="23.34" data-path="solutions.html"><a href="solutions.html#cor_solutions"><i class="fa fa-check"></i><b>23.34</b> Коэффициент корреляции</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ссылки-на-литературу.html"><a href="ссылки-на-литературу.html"><i class="fa fa-check"></i>Ссылки на литературу</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Анализ данных и статистика в R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cov_cor" class="section level1" number="16">
<h1><span class="header-section-number">16</span> Ковариация и корреляция</h1>
<p>Возьмем новый набор данных, на этот раз про американских студентов, вес их рюкзаков и проблемы со спиной. Этот набор данных хранится в пакете <code>Stat2Data</code> — пакет с большим количеством разнообразных данных.</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="cov_cor.html#cb857-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;Stat2Data&quot;</span>)</span></code></pre></div>
<p>С помощью функции <code>data()</code> загрузим набор данных <code>Backpack</code>:</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="cov_cor.html#cb858-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb858-2"><a href="cov_cor.html#cb858-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span>
<span id="cb858-3"><a href="cov_cor.html#cb858-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Backpack)</span></code></pre></div>
<p>Давайте посмотрим, что внутри этой переменной:</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="cov_cor.html#cb859-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(Backpack)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-417">Таблица 16.1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Backpack</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">100</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">9</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">factor</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">ordered</th>
<th align="right">n_unique</th>
<th align="left">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Major</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">41</td>
<td align="left">Bio: 9, Bus: 8, LS: 7, ME: 6</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">Fem: 55, Mal: 45</td>
</tr>
<tr class="odd">
<td align="left">Status</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">U: 97, G: 3</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">BackpackWeight</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">11.66</td>
<td align="right">5.77</td>
<td align="right">2.00</td>
<td align="right">8.00</td>
<td align="right">11.00</td>
<td align="right">14.25</td>
<td align="right">35.00</td>
<td align="left">▅▇▂▁▁</td>
</tr>
<tr class="even">
<td align="left">BodyWeight</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">153.05</td>
<td align="right">29.40</td>
<td align="right">105.00</td>
<td align="right">130.00</td>
<td align="right">147.50</td>
<td align="right">170.00</td>
<td align="right">270.00</td>
<td align="left">▆▇▂▁▁</td>
</tr>
<tr class="odd">
<td align="left">Ratio</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.08</td>
<td align="right">0.04</td>
<td align="right">0.02</td>
<td align="right">0.05</td>
<td align="right">0.07</td>
<td align="right">0.10</td>
<td align="right">0.18</td>
<td align="left">▆▇▆▃▁</td>
</tr>
<tr class="even">
<td align="left">BackProblems</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.32</td>
<td align="right">0.47</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="left">▇▁▁▁▃</td>
</tr>
<tr class="odd">
<td align="left">Year</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3.20</td>
<td align="right">1.39</td>
<td align="right">0.00</td>
<td align="right">2.00</td>
<td align="right">3.00</td>
<td align="right">4.00</td>
<td align="right">6.00</td>
<td align="left">▃▆▇▆▆</td>
</tr>
<tr class="even">
<td align="left">Units</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">14.27</td>
<td align="right">2.81</td>
<td align="right">0.00</td>
<td align="right">13.00</td>
<td align="right">15.00</td>
<td align="right">16.00</td>
<td align="right">19.00</td>
<td align="left">▁▁▁▇▆</td>
</tr>
</tbody>
</table>
<p>С помощью <code>?Backpack</code> можно получить подробное описание колонок этого датасета.</p>
<p>Например, можно заметить, что масса как самих студентов, так и их рюкзаков выражена в фунтах. Давайте создадим новые переменные <code>backpack_kg</code> и <code>body_kg</code>, в которых будет записан вес (рюкзаков и самих студентов соответственно) в понятным для нас килограммах. Новый набор данных сохраним под названием <code>back</code>.</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="cov_cor.html#cb860-1" aria-hidden="true" tabindex="-1"></a>back <span class="ot">&lt;-</span> Backpack <span class="sc">%&gt;%</span></span>
<span id="cb860-2"><a href="cov_cor.html#cb860-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">backpack_kg =</span> <span class="fl">0.45359237</span> <span class="sc">*</span> BackpackWeight,</span>
<span id="cb860-3"><a href="cov_cor.html#cb860-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">body_kg =</span> <span class="fl">0.45359237</span> <span class="sc">*</span> BodyWeight)</span></code></pre></div>
<p>До этого мы говорили о <em>различиях</em> между выборками. Теперь мы будем говорить о <em>связи</em> между переменными.</p>
<div id="cov" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Ковариация</h2>
<p>Самая простая мера связи между двумя переменными — это ковариация. Если <strong>ковариация положительная</strong>, то чем <em>больше</em> одна переменная, тем <em>больше</em> другая переменная. При <strong>отрицательной ковариации</strong> все наоборот: чем <em>больше</em> одна переменная, тем <em>меньше</em> другая.</p>
<ul>
<li>Формула ковариации:</li>
</ul>
<p><span class="math display">\[\sigma_{xy} = cov(x, y) = \frac{\sum_{i = 1}^n(x_i - \overline{x})(y_i - \overline{y})}{n}\]</span></p>
<ul>
<li>Оценка ковариации по выборке:</li>
</ul>
<p><span class="math display">\[\hat{\sigma}_{xy} = \frac{\sum_{i = 1}^n(x_i - \overline{x})(y_i - \overline{y})}{n-1}\]</span></p>
<p>Ковариация переменной самой с собой — дисперсия.</p>
<p>В R есть функция <code>cov()</code> для подсчета ковариации. На самом деле, функция <code>var()</code> делает то же самое. Обе эти функции считают сразу <strong>матрицу ковариаций</strong> для всех сочетаний колонок на входе:</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="cov_cor.html#cb861-1" aria-hidden="true" tabindex="-1"></a>back <span class="sc">%&gt;%</span></span>
<span id="cb861-2"><a href="cov_cor.html#cb861-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(body_kg, backpack_kg) <span class="sc">%&gt;%</span></span>
<span id="cb861-3"><a href="cov_cor.html#cb861-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>()</span></code></pre></div>
<pre><code>##                body_kg backpack_kg
## body_kg     177.807700    6.601954
## backpack_kg   6.601954    6.838333</code></pre>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="cov_cor.html#cb863-1" aria-hidden="true" tabindex="-1"></a>back <span class="sc">%&gt;%</span></span>
<span id="cb863-2"><a href="cov_cor.html#cb863-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(body_kg, backpack_kg) <span class="sc">%&gt;%</span></span>
<span id="cb863-3"><a href="cov_cor.html#cb863-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span>()</span></code></pre></div>
<pre><code>##                body_kg backpack_kg
## body_kg     177.807700    6.601954
## backpack_kg   6.601954    6.838333</code></pre>
<p>Ну а по углам этой матрицы – дисперсии!</p>
<p>Однако у ковариации есть серьезное ограничение – ее размер привязан к исходной шкале, поэтому сложно оценить, насколько ковариация большая или маленькая. Поэтому на практике гораздо больше используются коэффициенты корреляции.</p>
</div>
<div id="cor" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> Корреляция</h2>
<p><strong>Корреляцией</strong> обычно называют любую связь между двумя переменными, это просто синоним слова “ассоциация.” Если вдруг слово “корреляция” вам еще непривычно, то попробуйте мысленно заменять “корреляцию” на “ассоциацию,” а “коррелирует” на “связано.”
<strong>Коэффициент корреляции</strong> — это уже конкретная математическая формула, которая позволяет посчитать эту связь и принимает значения от -1 до 1.<a href="#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a></p>
<ul>
<li><p>Если коэффициент корреляции <strong>положительный</strong>, то чем <strong>больше</strong> значения в одной переменной, тем <strong>больше</strong> значения в другой переменной.</p></li>
<li><p>Если коэффициент корреляции <strong>отрицательный</strong>, то чем <strong>больше</strong> значения в одной переменной, тем <strong>меньше</strong> значения в другой переменной.</p></li>
<li><p>Если коэффициент корреляции равен 0, то изменения одной переменной не связано с изменениями в другой переменной.</p></li>
</ul>
<div id="pearson_cor" class="section level3" number="16.2.1">
<h3><span class="header-section-number">16.2.1</span> Коэффициент корреляции Пирсона</h3>
<p>Самый известный коэффициент корреляции - коэффициент корреляции Пирсона:</p>
<p><span class="math display">\[\rho_{xy} = \frac{\sigma_{xy}}{\sigma_x \sigma_y} = \frac{\sum_{i = 1}^n(x_i - \overline{x})(y_i - \overline{y})}{\sqrt{\sum_{i = 1}^n(x_i - \overline{x})^2}\sqrt{\sum_{i = 1}^n(y_i - \overline{y})^2}} = \frac{1}{n}\sum_{i = 1}^n z_{x,i} z_{y, i}\]</span></p>
<p>Оценка коэффициента корреляции Пирсона по выборке:
<span class="math display">\[r_{xy} = \frac{\hat{\sigma}_{xy}}{\hat{\sigma}_x \hat{\sigma}_y} = \frac{\sum_{i = 1}^n(x_i - \overline{x})(y_i - \overline{y})}{\sqrt{\sum_{i = 1}^n(x_i - \overline{x})^2}\sqrt{\sum_{i = 1}^n(y_i - \overline{y})^2}} = \frac{1}{n - 1}\sum_{i = 1}^n z_{x,i} z_{y, i}\]</span></p>
<p>Коэффициент корреляции Пирсона можно понимать по-разному. С одной стороны, это просто ковариация, нормированная на стандартное отклонение обоих переменных. С другой стороны, можно понимать это как среднее произведение z-оценок.</p>
<p>Корреляцию в R можно посчитать с помощью функции <code>cor()</code>:</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="cov_cor.html#cb865-1" aria-hidden="true" tabindex="-1"></a>back <span class="sc">%&gt;%</span></span>
<span id="cb865-2"><a href="cov_cor.html#cb865-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(body_kg, backpack_kg) <span class="sc">%&gt;%</span></span>
<span id="cb865-3"><a href="cov_cor.html#cb865-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span></code></pre></div>
<pre><code>##               body_kg backpack_kg
## body_kg     1.0000000   0.1893312
## backpack_kg 0.1893312   1.0000000</code></pre>
<p>Для тестирования уровня значимости нулевой гипотезы для корреляции есть функция <code>cor.test()</code>. В случае с коэффициентами корреляции, нулевая гипотеза формулируется как отсутствие корреляции (т.е. она равна нулю) в генеральной совокупности.</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="cov_cor.html#cb867-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(back<span class="sc">$</span>backpack_kg, back<span class="sc">$</span>body_kg)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  back$backpack_kg and back$body_kg
## t = 1.9088, df = 98, p-value = 0.05921
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.007360697  0.371918344
## sample estimates:
##       cor 
## 0.1893312</code></pre>
<p>Результат выполнения этой функции очень похож на то, что мы получали при проведении t-теста.</p>
</div>
<div id="nonparam_cor" class="section level3" number="16.2.2">
<h3><span class="header-section-number">16.2.2</span> Непараметрические коэффициенты корреляции</h3>
<p>У коэффициента корреляции Пирсона, как и у t-теста, есть свои непараметрические братья: коэффициент корреляции Спирмена и коэффициент корреляции Кэнделла. Из них чаще используется коэффициент корреляции Спирмена. Посчитать его можно с помощью той же функции <code>cor.test()</code>, задав соответствующее значение параметра <code>method =</code>:</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="cov_cor.html#cb869-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(back<span class="sc">$</span>backpack_kg, back<span class="sc">$</span>body_kg, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  back$backpack_kg and back$body_kg
## S = 131520, p-value = 0.03527
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.2108001</code></pre>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="cov_cor.html#cb871-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(back<span class="sc">$</span>backpack_kg, back<span class="sc">$</span>body_kg, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  back$backpack_kg and back$body_kg
## z = 2.083, p-value = 0.03725
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.1478736</code></pre>
<blockquote>
<p>Заметьте, в данном случае два метода хотя и привели к схожим размерам корреляции, но в одном случае <em>p-value</em> оказался больше 0.05, а в другом случае - меньше 0.05. Выбирать тест <em>a posteriori</em> на основе того, какие результаты вам нравятся больше, — плохая практика (@ref(bad_practice)). Не надо так делать.</p>
</blockquote>
</div>
</div>
<div id="cor_mat" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> Корреляционная матрица</h2>
<p>Возможно, вы нашли что-то более интересное для проверки гипотезы о корреляции. Например, вы еще хотите проверить гипотезу о связи количества учебных кредитов и массе рюкзака: логично предположить, что чем больше студент набрал себе курсов, тем тяжелее его рюкзак (из-за большего количества учебников). Или что студенты к старшим курсам худеют и становятся меньше. Или что те, кто набрал себе много курсов, меньше питаются и от того меньше весят. В общем, хотелось бы прокоррелировать все интересующие нас переменные со всеми. Это можно сделать с помощью функции <code>cor()</code>:</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="cov_cor.html#cb873-1" aria-hidden="true" tabindex="-1"></a>back <span class="sc">%&gt;%</span></span>
<span id="cb873-2"><a href="cov_cor.html#cb873-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(body_kg, backpack_kg, Units, Year) <span class="sc">%&gt;%</span></span>
<span id="cb873-3"><a href="cov_cor.html#cb873-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span></code></pre></div>
<pre><code>##                 body_kg backpack_kg       Units        Year
## body_kg      1.00000000  0.18933115 -0.23524088 -0.09301727
## backpack_kg  0.18933115  1.00000000  0.09438453  0.05762194
## Units       -0.23524088  0.09438453  1.00000000 -0.02946373
## Year        -0.09301727  0.05762194 -0.02946373  1.00000000</code></pre>
<p>Но функция <code>cor()</code>не позволяет посчитать <em>p-value</em> для этих корреляций! Функция <code>cor.test()</code> позволяет получить <em>p-value</em>, но только для одной пары переменных.</p>
<p>На помощь приходит пакет <code>psych</code> с функцией <code>corr.test()</code>:</p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="cov_cor.html#cb875-1" aria-hidden="true" tabindex="-1"></a>back <span class="sc">%&gt;%</span></span>
<span id="cb875-2"><a href="cov_cor.html#cb875-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(body_kg, backpack_kg, Units, Year) <span class="sc">%&gt;%</span></span>
<span id="cb875-3"><a href="cov_cor.html#cb875-3" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">corr.test</span>()</span></code></pre></div>
<pre><code>## Call:psych::corr.test(x = .)
## Correlation matrix 
##             body_kg backpack_kg Units  Year
## body_kg        1.00        0.19 -0.24 -0.09
## backpack_kg    0.19        1.00  0.09  0.06
## Units         -0.24        0.09  1.00 -0.03
## Year          -0.09        0.06 -0.03  1.00
## Sample Size 
## [1] 100
## Probability values (Entries above the diagonal are adjusted for multiple tests.) 
##             body_kg backpack_kg Units Year
## body_kg        0.00        0.30  0.11    1
## backpack_kg    0.06        0.00  1.00    1
## Units          0.02        0.35  0.00    1
## Year           0.36        0.57  0.77    0
## 
##  To see confidence intervals of the correlations, print with the short=FALSE option</code></pre>
<p>Тем не менее, если у вас много гипотез для тестирования, то у вас появляется проблема: вероятность выпадения статистически значимых результатов сильно повышается. Даже если эти переменные никак не связаны друг с другом.</p>
<p>Эта проблема называется <strong>проблемой множественных сравнений (multiple comparisons problem)</strong>.<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a> Если мы проверяем сразу несколько гипотез, то у нас возрастает <strong>групповая вероятность ошибки первого рода (Family-wise error rate)</strong> — вероятность ошибки первого рода для хотя бы одной из множества гипотез.</p>
<p>Например, если вы коррелируете 10 переменных друг с другом, то вы проверяете 45 гипотез о связи. Пять процентов из этих гипотез, т.е. в среднем 2-3 гипотезы у вас будут статистически значимыми даже если никаких эффектов на самом деле нет!</p>
<p>Поэтому если вы проверяете сразу много гипотез, то необходимо применять <strong>поправки на множественные сравнения (multiple testing correction)</strong>. Эти поправки позволяют контролировать групповую вероятность ошибки первого рода на желаемом уровне. Самая простая и популярная поправка на множественные сравнения — <strong>поправка Бонферрони (Bonferroni correction)</strong>. Она считается очень просто: мы просто умножаем p-value на количество проверяемых гипотез!</p>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="cov_cor.html#cb877-1" aria-hidden="true" tabindex="-1"></a>back <span class="sc">%&gt;%</span></span>
<span id="cb877-2"><a href="cov_cor.html#cb877-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(body_kg, backpack_kg, Units, Year) <span class="sc">%&gt;%</span></span>
<span id="cb877-3"><a href="cov_cor.html#cb877-3" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">corr.test</span>(<span class="at">adjust =</span> <span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>## Call:psych::corr.test(x = ., adjust = &quot;bonferroni&quot;)
## Correlation matrix 
##             body_kg backpack_kg Units  Year
## body_kg        1.00        0.19 -0.24 -0.09
## backpack_kg    0.19        1.00  0.09  0.06
## Units         -0.24        0.09  1.00 -0.03
## Year          -0.09        0.06 -0.03  1.00
## Sample Size 
## [1] 100
## Probability values (Entries above the diagonal are adjusted for multiple tests.) 
##             body_kg backpack_kg Units Year
## body_kg        0.00        0.36  0.11    1
## backpack_kg    0.06        0.00  1.00    1
## Units          0.02        0.35  0.00    1
## Year           0.36        0.57  0.77    0
## 
##  To see confidence intervals of the correlations, print with the short=FALSE option</code></pre>
<p>Это очень “дубовая” и излишне консервативная поправка. Да, она гарантирует контроль групповую вероятности ошибки первого рода, но при этом сильно повышает вероятность ошибки второго рода — вероятность пропустить эффект, если он на самом деле существует. Поэтому по умолчанию в R используется более либеральная поправка на множественные сравнения под названием <strong>поправка Холма</strong> или <strong>поправка Холма-Бонферрони (Holm-Bonferroni correction)</strong>, которая, тем не менее, тоже гарантирует контроль групповой вероятности ошибки первого рода.</p>
<p>Альтернативный подход к решению проблемы множественных сравнений — это контроль <strong>средней доли ложных отклонений (False Discovery Rate; FDR)</strong> на на уровне не выше уровня <span class="math inline">\(\alpha\)</span>. Это более либеральный подход: в данном случае мы контролируем, что ложно-положительных результатов у нас не больше, например, 5%. Такой подход применяется в областях, где происходит масштабное множественное тестирование. Попытка контролировать <em>групповую вероятность ошибки первого уровня</em> не выше уровня <span class="math inline">\(\alpha\)</span> привела бы к чрезвычайно низкой вероятности обнаружить хоть какие-нибудь эффекты (т.е. к низкой статистической мощности).</p>
<p>Самая известная поправка для контроля <em>средней доли ложных отклонений</em> — это <strong>поправка Бенджамини — Хохберга (Benjamini-Hochberg correction).</strong></p>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="cov_cor.html#cb879-1" aria-hidden="true" tabindex="-1"></a>back <span class="sc">%&gt;%</span></span>
<span id="cb879-2"><a href="cov_cor.html#cb879-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(body_kg, backpack_kg, Units, Year) <span class="sc">%&gt;%</span></span>
<span id="cb879-3"><a href="cov_cor.html#cb879-3" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">corr.test</span>(<span class="at">adjust =</span> <span class="st">&quot;BH&quot;</span>)</span></code></pre></div>
<pre><code>## Call:psych::corr.test(x = ., adjust = &quot;BH&quot;)
## Correlation matrix 
##             body_kg backpack_kg Units  Year
## body_kg        1.00        0.19 -0.24 -0.09
## backpack_kg    0.19        1.00  0.09  0.06
## Units         -0.24        0.09  1.00 -0.03
## Year          -0.09        0.06 -0.03  1.00
## Sample Size 
## [1] 100
## Probability values (Entries above the diagonal are adjusted for multiple tests.) 
##             body_kg backpack_kg Units Year
## body_kg        0.00        0.18  0.11 0.54
## backpack_kg    0.06        0.00  0.54 0.68
## Units          0.02        0.35  0.00 0.77
## Year           0.36        0.57  0.77 0.00
## 
##  To see confidence intervals of the correlations, print with the short=FALSE option</code></pre>
<p>Все перечсиленные поправки (и еще несколько других) доступны не только в функции <code>corr.test()</code>, но и в базовом R с помощью функции <code>p.adjust()</code>. Эта функция принимает вектор из <em>p-value</em> и возвращает результат применения поправок.</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="cov_cor.html#cb881-1" aria-hidden="true" tabindex="-1"></a>p_vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.0001</span>, <span class="fl">0.06</span>, <span class="at">length.out =</span> <span class="dv">10</span>)</span>
<span id="cb881-2"><a href="cov_cor.html#cb881-2" aria-hidden="true" tabindex="-1"></a>p_vec</span></code></pre></div>
<pre><code>##  [1] 0.000100000 0.006755556 0.013411111 0.020066667 0.026722222 0.033377778
##  [7] 0.040033333 0.046688889 0.053344444 0.060000000</code></pre>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="cov_cor.html#cb883-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(p_vec) <span class="co">#по умолчанию используется поправка Холма-Бонферрони</span></span></code></pre></div>
<pre><code>##  [1] 0.0010000 0.0608000 0.1072889 0.1404667 0.1603333 0.1668889 0.1668889
##  [8] 0.1668889 0.1668889 0.1668889</code></pre>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="cov_cor.html#cb885-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(p_vec, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] 0.00100000 0.06755556 0.13411111 0.20066667 0.26722222 0.33377778
##  [7] 0.40033333 0.46688889 0.53344444 0.60000000</code></pre>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="cov_cor.html#cb887-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(p_vec, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] 0.00100000 0.03377778 0.04470370 0.05016667 0.05344444 0.05562963
##  [7] 0.05719048 0.05836111 0.05927160 0.06000000</code></pre>
</div>
<div id="hitmap_cor" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> Хитмэп корреляций</h2>
<p>Как видите, почти все коррелирует друг с другом, даже с учетом поправок. Такие множественные корреляции лучше всего смотреть с помощью хитмап-визуализации.</p>
<p>В качестве примера возьмем встроенный датасет <code>mtcars</code>, в котором есть множество количественных переменных.</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="cov_cor.html#cb889-1" aria-hidden="true" tabindex="-1"></a>mtcars</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["drat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["am"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["gear"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["carb"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"21.0","2":"6","3":"160.0","4":"110","5":"3.90","6":"2.620","7":"16.46","8":"0","9":"1","10":"4","11":"4","_rn_":"Mazda RX4"},{"1":"21.0","2":"6","3":"160.0","4":"110","5":"3.90","6":"2.875","7":"17.02","8":"0","9":"1","10":"4","11":"4","_rn_":"Mazda RX4 Wag"},{"1":"22.8","2":"4","3":"108.0","4":"93","5":"3.85","6":"2.320","7":"18.61","8":"1","9":"1","10":"4","11":"1","_rn_":"Datsun 710"},{"1":"21.4","2":"6","3":"258.0","4":"110","5":"3.08","6":"3.215","7":"19.44","8":"1","9":"0","10":"3","11":"1","_rn_":"Hornet 4 Drive"},{"1":"18.7","2":"8","3":"360.0","4":"175","5":"3.15","6":"3.440","7":"17.02","8":"0","9":"0","10":"3","11":"2","_rn_":"Hornet Sportabout"},{"1":"18.1","2":"6","3":"225.0","4":"105","5":"2.76","6":"3.460","7":"20.22","8":"1","9":"0","10":"3","11":"1","_rn_":"Valiant"},{"1":"14.3","2":"8","3":"360.0","4":"245","5":"3.21","6":"3.570","7":"15.84","8":"0","9":"0","10":"3","11":"4","_rn_":"Duster 360"},{"1":"24.4","2":"4","3":"146.7","4":"62","5":"3.69","6":"3.190","7":"20.00","8":"1","9":"0","10":"4","11":"2","_rn_":"Merc 240D"},{"1":"22.8","2":"4","3":"140.8","4":"95","5":"3.92","6":"3.150","7":"22.90","8":"1","9":"0","10":"4","11":"2","_rn_":"Merc 230"},{"1":"19.2","2":"6","3":"167.6","4":"123","5":"3.92","6":"3.440","7":"18.30","8":"1","9":"0","10":"4","11":"4","_rn_":"Merc 280"},{"1":"17.8","2":"6","3":"167.6","4":"123","5":"3.92","6":"3.440","7":"18.90","8":"1","9":"0","10":"4","11":"4","_rn_":"Merc 280C"},{"1":"16.4","2":"8","3":"275.8","4":"180","5":"3.07","6":"4.070","7":"17.40","8":"0","9":"0","10":"3","11":"3","_rn_":"Merc 450SE"},{"1":"17.3","2":"8","3":"275.8","4":"180","5":"3.07","6":"3.730","7":"17.60","8":"0","9":"0","10":"3","11":"3","_rn_":"Merc 450SL"},{"1":"15.2","2":"8","3":"275.8","4":"180","5":"3.07","6":"3.780","7":"18.00","8":"0","9":"0","10":"3","11":"3","_rn_":"Merc 450SLC"},{"1":"10.4","2":"8","3":"472.0","4":"205","5":"2.93","6":"5.250","7":"17.98","8":"0","9":"0","10":"3","11":"4","_rn_":"Cadillac Fleetwood"},{"1":"10.4","2":"8","3":"460.0","4":"215","5":"3.00","6":"5.424","7":"17.82","8":"0","9":"0","10":"3","11":"4","_rn_":"Lincoln Continental"},{"1":"14.7","2":"8","3":"440.0","4":"230","5":"3.23","6":"5.345","7":"17.42","8":"0","9":"0","10":"3","11":"4","_rn_":"Chrysler Imperial"},{"1":"32.4","2":"4","3":"78.7","4":"66","5":"4.08","6":"2.200","7":"19.47","8":"1","9":"1","10":"4","11":"1","_rn_":"Fiat 128"},{"1":"30.4","2":"4","3":"75.7","4":"52","5":"4.93","6":"1.615","7":"18.52","8":"1","9":"1","10":"4","11":"2","_rn_":"Honda Civic"},{"1":"33.9","2":"4","3":"71.1","4":"65","5":"4.22","6":"1.835","7":"19.90","8":"1","9":"1","10":"4","11":"1","_rn_":"Toyota Corolla"},{"1":"21.5","2":"4","3":"120.1","4":"97","5":"3.70","6":"2.465","7":"20.01","8":"1","9":"0","10":"3","11":"1","_rn_":"Toyota Corona"},{"1":"15.5","2":"8","3":"318.0","4":"150","5":"2.76","6":"3.520","7":"16.87","8":"0","9":"0","10":"3","11":"2","_rn_":"Dodge Challenger"},{"1":"15.2","2":"8","3":"304.0","4":"150","5":"3.15","6":"3.435","7":"17.30","8":"0","9":"0","10":"3","11":"2","_rn_":"AMC Javelin"},{"1":"13.3","2":"8","3":"350.0","4":"245","5":"3.73","6":"3.840","7":"15.41","8":"0","9":"0","10":"3","11":"4","_rn_":"Camaro Z28"},{"1":"19.2","2":"8","3":"400.0","4":"175","5":"3.08","6":"3.845","7":"17.05","8":"0","9":"0","10":"3","11":"2","_rn_":"Pontiac Firebird"},{"1":"27.3","2":"4","3":"79.0","4":"66","5":"4.08","6":"1.935","7":"18.90","8":"1","9":"1","10":"4","11":"1","_rn_":"Fiat X1-9"},{"1":"26.0","2":"4","3":"120.3","4":"91","5":"4.43","6":"2.140","7":"16.70","8":"0","9":"1","10":"5","11":"2","_rn_":"Porsche 914-2"},{"1":"30.4","2":"4","3":"95.1","4":"113","5":"3.77","6":"1.513","7":"16.90","8":"1","9":"1","10":"5","11":"2","_rn_":"Lotus Europa"},{"1":"15.8","2":"8","3":"351.0","4":"264","5":"4.22","6":"3.170","7":"14.50","8":"0","9":"1","10":"5","11":"4","_rn_":"Ford Pantera L"},{"1":"19.7","2":"6","3":"145.0","4":"175","5":"3.62","6":"2.770","7":"15.50","8":"0","9":"1","10":"5","11":"6","_rn_":"Ferrari Dino"},{"1":"15.0","2":"8","3":"301.0","4":"335","5":"3.54","6":"3.570","7":"14.60","8":"0","9":"1","10":"5","11":"8","_rn_":"Maserati Bora"},{"1":"21.4","2":"4","3":"121.0","4":"109","5":"4.11","6":"2.780","7":"18.60","8":"1","9":"1","10":"4","11":"2","_rn_":"Volvo 142E"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Для визуализации возьмем пакет <code>{corrplot}</code>.</p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="cov_cor.html#cb890-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;corrplot&quot;</span>)</span></code></pre></div>
<p>Для начала нам нужно построить матрицу корреляций. Уже знакомая нам функция <code>cor()</code> для это вполне подойдет:</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="cov_cor.html#cb891-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb891-2"><a href="cov_cor.html#cb891-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(mtcars)</span></code></pre></div>
<pre><code>##             mpg        cyl       disp         hp        drat         wt
## mpg   1.0000000 -0.8521620 -0.8475514 -0.7761684  0.68117191 -0.8676594
## cyl  -0.8521620  1.0000000  0.9020329  0.8324475 -0.69993811  0.7824958
## disp -0.8475514  0.9020329  1.0000000  0.7909486 -0.71021393  0.8879799
## hp   -0.7761684  0.8324475  0.7909486  1.0000000 -0.44875912  0.6587479
## drat  0.6811719 -0.6999381 -0.7102139 -0.4487591  1.00000000 -0.7124406
## wt   -0.8676594  0.7824958  0.8879799  0.6587479 -0.71244065  1.0000000
## qsec  0.4186840 -0.5912421 -0.4336979 -0.7082234  0.09120476 -0.1747159
## vs    0.6640389 -0.8108118 -0.7104159 -0.7230967  0.44027846 -0.5549157
## am    0.5998324 -0.5226070 -0.5912270 -0.2432043  0.71271113 -0.6924953
## gear  0.4802848 -0.4926866 -0.5555692 -0.1257043  0.69961013 -0.5832870
## carb -0.5509251  0.5269883  0.3949769  0.7498125 -0.09078980  0.4276059
##             qsec         vs          am       gear        carb
## mpg   0.41868403  0.6640389  0.59983243  0.4802848 -0.55092507
## cyl  -0.59124207 -0.8108118 -0.52260705 -0.4926866  0.52698829
## disp -0.43369788 -0.7104159 -0.59122704 -0.5555692  0.39497686
## hp   -0.70822339 -0.7230967 -0.24320426 -0.1257043  0.74981247
## drat  0.09120476  0.4402785  0.71271113  0.6996101 -0.09078980
## wt   -0.17471588 -0.5549157 -0.69249526 -0.5832870  0.42760594
## qsec  1.00000000  0.7445354 -0.22986086 -0.2126822 -0.65624923
## vs    0.74453544  1.0000000  0.16834512  0.2060233 -0.56960714
## am   -0.22986086  0.1683451  1.00000000  0.7940588  0.05753435
## gear -0.21268223  0.2060233  0.79405876  1.0000000  0.27407284
## carb -0.65624923 -0.5696071  0.05753435  0.2740728  1.00000000</code></pre>
<p>Основная функция пакета <code>{corrplot}</code> – функция <code>corrplot()</code>. Давайте теперь попробуем ее применить на нашей матрице корреляций.</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="cov_cor.html#cb893-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(mtcars))</span></code></pre></div>
<p><img src="tidy_stats_files/figure-html/unnamed-chunk-431-1.png" width="672" />
По умолчанию значение корреляций кодируется цветом и размером круга. У функции <code>corrplot()</code> есть множество параметров, позволяющих довольно тонко настраивать хитмэп корреляций. Например, можнокодировать только цветом, а переменные сгруппировать на основе кластеризации.</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="cov_cor.html#cb894-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(mtcars), <span class="at">method =</span> <span class="st">&quot;color&quot;</span>, <span class="at">order =</span> <span class="st">&quot;hclust&quot;</span>)</span></code></pre></div>
<p><img src="tidy_stats_files/figure-html/unnamed-chunk-432-1.png" width="672" /></p>
</div>
<div id="матрица-корреляций-в-виде-графа" class="section level2" number="16.5">
<h2><span class="header-section-number">16.5</span> Матрица корреляций в виде графа</h2>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="cov_cor.html#cb895-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;corrr&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="cov_cor.html#cb896-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span></code></pre></div>
<p>Функционал пакета {corrr} позволяет работать с корреляционными матрицами в духе tidyverse, возвращая тиббл вместо матрицы.</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="cov_cor.html#cb897-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlate</span>(mtcars)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["disp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["am"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["gear"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["carb"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"mpg","2":"NA","3":"-0.8521620","4":"-0.8475514","5":"-0.7761684","6":"0.68117191","7":"-0.8676594","8":"0.41868403","9":"0.6640389","10":"0.59983243","11":"0.4802848","12":"-0.55092507"},{"1":"cyl","2":"-0.8521620","3":"NA","4":"0.9020329","5":"0.8324475","6":"-0.69993811","7":"0.7824958","8":"-0.59124207","9":"-0.8108118","10":"-0.52260705","11":"-0.4926866","12":"0.52698829"},{"1":"disp","2":"-0.8475514","3":"0.9020329","4":"NA","5":"0.7909486","6":"-0.71021393","7":"0.8879799","8":"-0.43369788","9":"-0.7104159","10":"-0.59122704","11":"-0.5555692","12":"0.39497686"},{"1":"hp","2":"-0.7761684","3":"0.8324475","4":"0.7909486","5":"NA","6":"-0.44875912","7":"0.6587479","8":"-0.70822339","9":"-0.7230967","10":"-0.24320426","11":"-0.1257043","12":"0.74981247"},{"1":"drat","2":"0.6811719","3":"-0.6999381","4":"-0.7102139","5":"-0.4487591","6":"NA","7":"-0.7124406","8":"0.09120476","9":"0.4402785","10":"0.71271113","11":"0.6996101","12":"-0.09078980"},{"1":"wt","2":"-0.8676594","3":"0.7824958","4":"0.8879799","5":"0.6587479","6":"-0.71244065","7":"NA","8":"-0.17471588","9":"-0.5549157","10":"-0.69249526","11":"-0.5832870","12":"0.42760594"},{"1":"qsec","2":"0.4186840","3":"-0.5912421","4":"-0.4336979","5":"-0.7082234","6":"0.09120476","7":"-0.1747159","8":"NA","9":"0.7445354","10":"-0.22986086","11":"-0.2126822","12":"-0.65624923"},{"1":"vs","2":"0.6640389","3":"-0.8108118","4":"-0.7104159","5":"-0.7230967","6":"0.44027846","7":"-0.5549157","8":"0.74453544","9":"NA","10":"0.16834512","11":"0.2060233","12":"-0.56960714"},{"1":"am","2":"0.5998324","3":"-0.5226070","4":"-0.5912270","5":"-0.2432043","6":"0.71271113","7":"-0.6924953","8":"-0.22986086","9":"0.1683451","10":"NA","11":"0.7940588","12":"0.05753435"},{"1":"gear","2":"0.4802848","3":"-0.4926866","4":"-0.5555692","5":"-0.1257043","6":"0.69961013","7":"-0.5832870","8":"-0.21268223","9":"0.2060233","10":"0.79405876","11":"NA","12":"0.27407284"},{"1":"carb","2":"-0.5509251","3":"0.5269883","4":"0.3949769","5":"0.7498125","6":"-0.09078980","7":"0.4276059","8":"-0.65624923","9":"-0.5696071","10":"0.05753435","11":"0.2740728","12":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Нас же интересует в первую очередь представление матрицы корреляций в виде графа.</p>
<p>Делается это следующим образом: мы устанавливаем минимальное значение для корреляций с помощью параметра <code>min_cor =</code>, которые будут отображены в качестве связи между переменными. Если мы этого не сделаем, то мы просто получим полностью связанный граф, потому что все переменные хотя бы немного коррелируют со всеми. По умолчанию этот параметр равен 0.3, но мы можем изменить это значение на собственное усмотрение. В данном случае установим <code>min_cor = 0.7</code>, потому что в нашей матрице очень много сильных корреляций.</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="cov_cor.html#cb898-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlate</span>(mtcars) <span class="sc">%&gt;%</span></span>
<span id="cb898-2"><a href="cov_cor.html#cb898-2" aria-hidden="true" tabindex="-1"></a>  corrr<span class="sc">::</span><span class="fu">network_plot</span>(<span class="at">min_cor =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="tidy_stats_files/figure-html/unnamed-chunk-436-1.png" width="672" /></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="39">
<li id="fn39"><p>Впрочем, это не так уж и важно: на практике часто опускают слово “коэффициент” и называют корреляцией как и просто связь, так и ее способ измерения.<a href="cov_cor.html#fnref39" class="footnote-back">↩︎</a></p></li>
<li id="fn40"><p>“Проблема множественных сравнений” - это устоявшийся термин, который используется и в случае множественных корреляций, и в случае множественных сравнений средних и в любых других случаях с тестированием нескольких гипотез одновременно.<a href="cov_cor.html#fnref40" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ttest.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Pozdniakov/tidy_stats/edit/master/04-4-cov_cor.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["tidy_stats.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
